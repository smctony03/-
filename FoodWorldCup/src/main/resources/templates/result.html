<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì˜¤ëŠ˜ì˜ ë©”ë‰´ ê²°ì •</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Jua', sans-serif; text-align: center; background-color: #222; color: white; margin: 0; padding-top: 50px; }

        h1 { color: #FFD700; margin-bottom: 10px; }
        p { color: #ccc; font-size: 1.2rem; }

        .gacha-section { margin-top: 40px; }
        .card-container { display: flex; justify-content: center; gap: 30px; margin-top: 30px; }

        /* ì¹´ë“œ ë””ìì¸ */
        .card {
            width: 220px; height: 320px;
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            border-radius: 15px;
            display: flex; align-items: center; justify-content: center;
            font-size: 80px; cursor: pointer;
            transition: 0.6s; transform-style: preserve-3d;
            border: 4px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .card:hover { transform: translateY(-10px); border-color: #FFD700; }
        .card.flipped { transform: rotateY(180deg); background: white; }

        .card-content { display: none; transform: rotateY(180deg); flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; }
        .card.flipped .card-content { display: flex; }
        .card.flipped span { display: none; }

        .card-img { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin-bottom: 15px; border: 3px solid #ddd; }
        .card h3 { color: #333; font-size: 1.8rem; margin: 0; }
        .tag { font-size: 1rem; color: #FF6B6B; margin-top: 5px; font-weight: bold; }

        /* ê²°ê³¼ ëª¨ë‹¬ */
        .winner-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 999; }
        .winner-modal img { width: 300px; height: 300px; border-radius: 50%; border: 8px solid gold; margin-bottom: 20px; animation: pop 0.5s; }
        @keyframes pop { from { transform: scale(0); } to { transform: scale(1); } }

        .btn-group { margin-top: 30px; display: flex; gap: 20px; }
        .btn { padding: 15px 35px; border-radius: 50px; font-size: 1.3rem; text-decoration: none; color: white; font-weight: bold; }
        .btn-map { background: #03C75A; }
        .btn-home { background: #FF6B6B; }
    </style>
</head>
<body>

<h1>ğŸ”® ìš´ëª…ì˜ ì¹´ë“œ ë½‘ê¸° ğŸ”®</h1>
<p>1ì°¨ ìš°ìŠ¹, 2ì°¨ ìš°ìŠ¹, ê·¸ë¦¬ê³  AI ì¶”ì²œ ë©”ë‰´ê°€ ìˆ¨ì–´ìˆìŠµë‹ˆë‹¤.</p>
<p>ë”± í•˜ë‚˜ë§Œ ê³¨ë¼ë³´ì„¸ìš”!</p>

<div class="card-container">
    <div class="card" onclick="flipCard(this, 0)">
        <span>â“</span>
        <div class="card-content">
            <img class="card-img" id="img0" src="">
            <h3 id="name0">ìŒì‹</h3>
            <div class="tag" id="tag0"></div>
        </div>
    </div>
    <div class="card" onclick="flipCard(this, 1)">
        <span>â“</span>
        <div class="card-content">
            <img class="card-img" id="img1" src="">
            <h3 id="name1">ìŒì‹</h3>
            <div class="tag" id="tag1"></div>
        </div>
    </div>
    <div class="card" onclick="flipCard(this, 2)">
        <span>â“</span>
        <div class="card-content">
            <img class="card-img" id="img2" src="">
            <h3 id="name2">ìŒì‹</h3>
            <div class="tag" id="tag2"></div>
        </div>
    </div>
</div>

<div id="winnerModal" class="winner-modal">
    <h2 style="color:gold;">ğŸ‘‘ ì˜¤ëŠ˜ì˜ ë©”ë‰´ í™•ì •! ğŸ‘‘</h2>
    <img id="final-img" src="">
    <h1 id="final-name" style="font-size: 3.5rem;">ìŒì‹ì´ë¦„</h1>

    <div class="btn-group">
        <a href="#" class="btn btn-map" onclick="searchNaver()">ğŸ“ ë§›ì§‘ ê²€ìƒ‰</a>
        <a href="/" class="btn btn-home" onclick="resetAll()">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</a>
    </div>
</div>

<script th:inline="javascript">
    // 3ê°œì˜ í›„ë³´ (1ì°¨, 2ì°¨, AI)
    let candidates = [
        { name: [[${card1.name}]], img: [[${card1.imgUrl}]], type: "ğŸ¥‡ 1ì°¨ì „ ìš°ìŠ¹" },
        { name: [[${card2.name}]], img: [[${card2.imgUrl}]], type: "ğŸ¥ˆ 2ì°¨ì „ ìš°ìŠ¹" },
        { name: [[${card3.name}]], img: [[${card3.imgUrl}]], type: "ğŸ¤– AI ê°•ë ¥ ì¶”ì²œ" }
    ];

    // ì¹´ë“œ ì„ê¸° (ì–´ë””ì— ë­ê°€ ìˆëŠ”ì§€ ëª¨ë¥´ê²Œ)
    candidates.sort(() => Math.random() - 0.5);

    let isFlipped = false;
    let finalFoodName = "";

    function flipCard(card, index) {
        if (isFlipped) return;
        isFlipped = true;

        // ë‚´ìš© ì±„ìš°ê¸°
        let picked = candidates[index];
        document.getElementById("img" + index).src = picked.img;
        document.getElementById("name" + index).innerText = picked.name;
        document.getElementById("tag" + index).innerText = picked.type;

        finalFoodName = picked.name;

        // ë’¤ì§‘ê¸° íš¨ê³¼
        card.classList.add("flipped");

        // 1ì´ˆ ë’¤ ê²°ê³¼ì°½
        setTimeout(() => {
            document.getElementById("final-img").src = picked.img;
            document.getElementById("final-name").innerText = picked.name;
            document.getElementById("winnerModal").style.display = "flex";
        }, 1000);
    }

    function searchNaver() {
        if (!finalFoodName) return;
        window.open("https://map.naver.com/v5/search/" + encodeURIComponent(finalFoodName + " ë§›ì§‘"), "_blank");
    }

    function resetAll() {
        localStorage.clear();
    }
</script>
</body>
</html>